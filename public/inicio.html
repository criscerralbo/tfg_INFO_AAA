<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestión de Usuarios - Gamificación en Odontología</title>
    <link rel="stylesheet" href="/css/inicio.css"> <!-- Estilos generales -->
</head>
<body>

    <!-- Header con título y usuario -->
    <header>
        <h1>Tu Aplicación de Gamificación</h1>
        <div class="user-section">
            <span id="user-greeting">Bienvenido</span> <!-- Aquí se cargará el nombre del usuario -->
            <button id="logout-button" class="logout-button">Cerrar Sesión</button>
            <!-- boton administrador que solo aparece a los usuarios administradores -->
            <button id="admin-button" class="admin-button" style="display: none;">Administración</button>
            <button id="btn-profesor-grupos" class="btn-profesor-grupos" style="display: none;">Mis Grupos</button>
            <button id="btn-alumno-grupos" class="btn-alumno-grupos" style="display: none;">Grupos</button>
            <div class="user-icon">
                <a href="/perfil.html">
                    <img src="images/usuario.png" alt="Usuario">
                </a>
            </div>
        </div>
    </header>

    <!-- Modal de confirmación de cierre de sesión -->
    <div id="logoutModal" class="modal">
        <div class="modal-content">
            <span class="close" id="closeModal">&times;</span>
            <h2>¿Estás seguro de que deseas cerrar sesión?</h2>
            <div class="modal-buttons">
                <button id="confirmLogout" class="confirm-button">Sí, cerrar sesión</button>
                <button id="cancelLogout" class="cancel-button">Cancelar</button>
            </div>
        </div>
    </div>
 <!-- Contenido principal -->
 <main class="welcome-section">
    <h2>Bienvenido a la Aplicación de Gamificación en Odontología</h2>
    <p>
        Esta plataforma está diseñada para mejorar el aprendizaje de los estudiantes de odontología a través de juegos interactivos y didácticos. 
        Aquí podrás participar en actividades, resolver casos clínicos y medir tu progreso de una manera divertida y educativa.
    </p>
    <div class="botones-section">
    <button id="btn-alumno-comenzar" class="btn-alumno-comenzar" style="display: block;">COMENZAR</button>
    <button id="btn-adm-juegos" class="btn-adm-juegos" style="display: none;">Administrar Juegos</button> <!-- Solo visible para administradores/profesores -->
    <button id="qr-button" class="qr-button" style="display: block;">GENERAR QR</button>
</div>
</main>
   
<!-- Footer -->
<footer>
    © 2024 Tu Aplicación - Desarrollada para el TFG de Cristina Cerralbo sobre Gamificación en Educación Odontológica
</footer>
    <script>
        // Cargar el nombre del usuario desde la sesión del servidor
        window.addEventListener('DOMContentLoaded', (event) => {
            fetch('/usuarios/nombre')
                .then(response => response.json())
                .then(data => {
                    if (data.nombreUsuario) {
                        document.getElementById('user-greeting').textContent = `Bienvenido, ${data.nombreUsuario}`;
                    } else {
                        document.getElementById('user-greeting').textContent = 'Bienvenido, Usuario';
                    }
                    if (data.rol === 'administrador') { // Mostrar botón solo si el usuario es administrador
                        document.getElementById('admin-button').style.display = 'block';
                    }
                    if (data.rol === 'profesor') { // Mostrar botón solo si el usuario es administrador
                        document.getElementById('btn-profesor-grupos').style.display = 'block';
                    }
                    if (data.rol === 'alumno') { // Mostrar botón solo si el usuario es administrador
                        document.getElementById('btn-alumno-grupos').style.display = 'block';
                    }

                    if (data.rol === 'profesor') { // Mostrar botón solo si el usuario es administrador
                        document.getElementById('btn-adm-juegos').style.display = 'block';
                    }
                })
                
                .catch(() => {
                    document.getElementById('user-greeting').textContent = 'Bienvenido, Usuario';
                });
        });
          // Redirigir al panel de administración
          document.getElementById('qr-button').addEventListener('click', function() {
                    window.location.href = '/qr.html';
                })
                // Redirigir al panel de administración
                document.getElementById('admin-button').addEventListener('click', function() {
                    window.location.href = '/admin.html';
                })
                // Redirigir al panel de administración
                document.getElementById('btn-profesor-grupos').addEventListener('click', function() {
                    window.location.href = '/profesor.html';
                })
                // Redirigir al panel de administración
                document.getElementById('btn-alumno-grupos').addEventListener('click', function() {
                    window.location.href = '/alumno.html';
                })
                // Redirigir al panel de administración
                document.getElementById('btn-alumno-comenzar').addEventListener('click', function() {
                    window.location.href = '/actividades-grupo.html';
                })
                // Redirigir al panel de administración
                document.getElementById('btn-adm-juegos').addEventListener('click', function() {
                    window.location.href = '/adm_juegos.html';
                })
        // Mostrar el modal de confirmación
        document.getElementById('logout-button').addEventListener('click', function() {
            document.getElementById('logoutModal').style.display = 'block';
        });

        // Cerrar el modal al hacer clic en "Cancelar" o en la "X"
        document.getElementById('cancelLogout').addEventListener('click', function() {
            document.getElementById('logoutModal').style.display = 'none';
        });

        document.getElementById('closeModal').addEventListener('click', function() {
            document.getElementById('logoutModal').style.display = 'none';
        });

        // Confirmar cierre de sesión
        document.getElementById('confirmLogout').addEventListener('click', function() {
            fetch('/usuarios/logout')
                .then(() => {
                    window.location.href = '/'; // Redirigir a la página de inicio de sesión
                });
        });
    </script>

   

</body>
</html>
